<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Polyhedral template matching</title><link rel="stylesheet" type="text/css" href="manual.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="OVITO User Manual"><link rel="up" href="particles.modifiers.html" title="Modifiers"><link rel="prev" href="particles.modifiers.manual_selection.html" title="Manual selection"><link rel="next" href="particles.modifiers.python_script.html" title="Python script modifier pro"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><a href="https://www.ovito.org/"><img src="images/ovito_logo.png" border="0" width="84"></a><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="h" href="index.html">Table of Contents</a></td><th width="60%" align="center">Polyhedral template matching</th><td width="20%" align="right"><a accesskey="u" href="particles.modifiers.html">Up</a></td></tr><tr><td width="20%" align="left"><a accesskey="p" href="particles.modifiers.manual_selection.html">Prev</a> </td><th width="60%" align="center">Modifiers</th><td width="20%" align="right"> <a accesskey="n" href="particles.modifiers.python_script.html">Next</a></td></tr></table></div><div class="section" id="particles.modifiers.polyhedral_template_matching"><div class="titlepage"><div><div><h3 class="title">Polyhedral template matching</h3></div></div></div>
  

  <p>
  This modifier classifies the local structural environment of particles
  using the <span class="emphasis"><em>Polyhedral Template Matching</em></span> (PTM) method, which allows identification of the local
  crystalline structure of simple condensed phases.
  This structure identification method has been described in </p><div class="blockquote"><blockquote class="blockquote"><div class="literallayout"><p><a class="ulink" href="https://dx.doi.org/10.1088/0965-0393/24/5/055007" target="_top">P. M. Larsen et al.<br>
Robust Structural Identification via Polyhedral Template Matching<br>
Modelling Simul. Mater. Sci. Eng. 24, 055007 (2016)<br>
doi:10.1088/0965-0393/24/5/055007<br>
</a></p></div></blockquote></div><p>Please cite this paper when you use this structure identification algorithm in your work. A preprint is available <a class="ulink" href="http://arxiv.org/abs/1603.05143" target="_top">here</a>.</p>
  <p>
  The PTM approach promises greater reliability than e.g. <a class="link" href="particles.modifiers.common_neighbor_analysis.html" title="Common neighbor analysis">Common Neighbor Analysis (CNA)</a> in the
  presence of strong thermal fluctuations and strains. Furthermore, it provides a direct calculation of the local (per-atom) crystal orientation, elastic deformation,
  strain and chemical ordering type.
  </p>
  <p>
    The modifier identifies local crystalline order by matching the local atomic neighborhood to the templates of the structural types determined by the PTM algorithm.  The templates use a mixture of nearest neighbors, and neighbors of neighbors:
    </p><div class="inlinefigure">
      <div class="informaltable">
        <table class="informaltable" style="border: none;"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><tbody><tr align="left" valign="top"><td style="" colspan="4" align="left" valign="top">Central atom (white), nearest neighbors (blue), and neighbors of neighbors (green).</td></tr><tr valign="top"><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_fcc.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_hcp.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_bcc.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_ico.png"></div>
              </td></tr><tr valign="top"><td style="" align="center" valign="top">FCC</td><td style="" align="center" valign="top">HCP</td><td style="" align="center" valign="top">BCC</td><td style="" align="center" valign="top">Icosahedral</td></tr><tr valign="top"><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_sc.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_dcub.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_dhex.png"></div>
              </td><td style="" align="center" valign="top">
		        <div class="mediaobject"><img src="images/modifiers/ptm_schematic_grp.png"></div>
              </td></tr><tr valign="top"><td style="" align="center" valign="top">Simple Cubic</td><td style="" align="center" valign="top">Cubic diamond</td><td style="" align="center" valign="top">Hexagonal diamond</td><td style="" align="center" valign="top">Graphene</td></tr></tbody></table>
      </div>
    </div><p>
    Determination of diamond and graphene structures is an extension of the published PTM method, though it follows similar principles.
  </p>

  <p>
  The modifier sets the <code class="literal">Structure Type</code> property for each particle, which is encoded as an integer value:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">0 = Other, unknown coordination structure</li><li class="listitem">1 = FCC, face-centered cubic</li><li class="listitem">2 = HCP, hexagonal close-packed</li><li class="listitem">3 = BCC, body-centered cubic</li><li class="listitem">4 = ICO, icosahedral coordination</li><li class="listitem">5 = SC, simple cubic</li><li class="listitem">6 = Cubic diamond</li><li class="listitem">7 = Hexagonal diamond</li><li class="listitem">8 = Graphene</li></ul></div><p>
  </p>
    <p>
      By default, the modifier will try to identify only the following structure types: FCC, HCP, BCC.
      Using the tick boxes in the list, you can specify the set of structural types the modifier should look for.
      In general, you will get cleaner results by only selecting relevant structures.
    </p>

    <div class="informalfigure"><div class="screenshot"><div class="mediaobject"><img src="images/modifiers/polyhedral_template_matching_panel.png" width="270"></div></div></div>

  <div class="simplesect" id="idp4623136"><div class="titlepage"><div><div><h4 class="title">Root-Mean-Square Deviation (RMSD)</h4></div></div></div>
    
    <p>
      For each input particle, the PTM tries to determine a mapping of the local neighborhood to each active candidate structure.
      If such a mapping exists, a RMSD value is calculated, which is a measure of the spatial deviation from the ideal structure template (the quality of the match).
      The structural type with the lowest RMSD value is finally assigned to the particle.
      A histogram of the RMSD values for all structures and all particles is shown in the side panel.
    </p>
    <p>
      The modifier allows to set a global RMSD cutoff, which limits the assignment of structural types to a range of RMSD values. Particles whose RMSD
      exceeds the threshold are assigned the <span class="emphasis"><em>Other</em></span> structure type.
      By adjusting the RMSD cutoff, the level of robustness can be adjusted.
      A higher RMSD cutoff will lead to more identifications (and fewer 'defect' atoms), though possibly at the expense of false positives.
      A lower RMSD cutoff will result in fewer structural identifications (and more 'defect' atoms and greater sensitivity to perturbations of the lattice),
      though possibly at the expense of false negatives. The role of the RMSD cutoff is discussed in section 5.1 of the PTM paper.
    </p>
    <p>
      A reasonable value for the RMSD cutoff parameter is 0.1, which works well for identifying defects in crystalline solids.
      Note that, for the sake of reproducibility, the chosen RMSD cutoff value should typically be reported in a publication if you use
      the PTM method to gain quantitative results (e.g. measure crystal defect densities).
    </p>
  </div>

  <div class="simplesect" id="idp4626960"><div class="titlepage"><div><div><h4 class="title">Interatomic distances</h4></div></div></div>
    
    <p>
      The internal scale factor computed by the PTM method (see the paper) is the amount by which the atom coordinates are scaled in order to minimize the RMSD between the atom and template coordinates,
      after translation and rotation. It is proportional to the reciprocal local interatomic distance (including hydrostatic strain components).
    </p>
    <p>
      The PTM modifier provides an option to output the local interatomic distance (or nearest neighbor distance) as a new particle property, which is computed from the internal scale factor for those atoms
      that match one of the known structure types.
      Note that you can compute a local lattice constant (including hydrostatic strain) from the interatomic distance by dividing it by the
      factor <span class="mathphrase">sqrt(1/2)</span> (for FCC, HCP), <span class="mathphrase">sqrt(3/4)</span> (for BCC), or <span class="mathphrase">sqrt(3/16)</span> (for cubic diamond and hexagonal diamond) using, e.g., the <a class="link" href="particles.modifiers.compute_property.html" title="Compute property">Compute property</a> modifier
    </p>
  </div>

  <div class="simplesect" id="idp4632224"><div class="titlepage"><div><div><h4 class="title">Local lattice orientations</h4></div></div></div>
    
    <p>
     The PTM modifier provides the option to calculate a local lattice orientation for atoms that match one of the structural types. The computed orientations are
     encoded as <a class="ulink" href="https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation" target="_top">quaternions</a> and stored in the <code class="literal">Orientation</code>
     particle property.
     To visualize the computed local lattice orientations, you can switch the <a class="link" href="visual_elements.particles.html" title="Particles (visual element)">particle display shape</a> to <span class="emphasis"><em>Cube/Box</em></span>
     or apply this <a class="pydoc-link" href="python/introduction/examples.html#example-visualize-local-lattice-orientation" target="_top">Python modifier script</a><a class="ovito-pro-tag" data-tooltip="This program feature is only available in the Pro edition of OVITO. Click to learn more." data-tooltip-position="bottom" href="https://www.ovito.org/about/ovito-pro/">
    pro
  </a> mapping the orientation information to a particle color.
     Lattice orientations are calculated such that they lie in the fundamental zone of the symmetry group for each structural type.
     This means that two atoms with very similar orientations can have large misorientations if they lie close to the boundaries of the fundamental zone.
     For atoms not matching any of the known structure types, no local lattice orientation can be computed. These atoms are assigned the invalid quaternion vector (0,0,0,0).
    </p>

    <p>
      Orientations are calculated relative to the following reference templates. In the table, the neighbor positions of each reference configuration
      are given in Cartesian coordinates with the central particle located at the origin.
      </p><div class="informaltable">
        <table class="informaltable" style="border-collapse: collapse;border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="index"><col class="FCCx"><col class="FCCy"><col class="FCCz"><col class="HCPx"><col class="HCPy"><col class="HCPz"><col class="BCCx"><col class="BCCy"><col class="BCCz"><col class="ICOx"><col class="ICOy"><col class="ICOz"><col class="SCx"><col class="SCy"><col class="SCz"><col class="DCUBx"><col class="DCUBy"><col class="DCUBz"><col class="DHEXx"><col class="DHEXy"><col class="DHEXz"><col class="GRPx"><col class="GRPy"><col class="GRPz"></colgroup><thead><tr><th style="border-right: 1px solid ; ">Neighbor</th><th style="" colspan="3"> FCC</th><th style="" colspan="3"> HCP</th><th style="" colspan="3"> BCC</th><th style="" colspan="3"> ICO</th><th style="" colspan="3">  Simple cubic</th><th style="" colspan="3">Cubic diamond</th><th style="" colspan="3">Hexagonal diamond</th><th style="" colspan="3">Graphene</th></tr></thead><tbody><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">1</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>3</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>5</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">2k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">2</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub>/3</td><td style="" align="right" valign="center">-4k<sub>1</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub>/3</td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>3</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>5</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>8</sub></td><td style="" align="right" valign="center">-k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">3</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>3</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>5</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>8</sub></td><td style="" align="right" valign="center">-k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">4</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub>/3</td><td style="" align="right" valign="center">-k<sub>1</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">-4k<sub>1</sub>/3</td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>3</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>5</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>8</sub></td><td style="" align="right" valign="center">3k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">5</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>3</sub></td><td style="" align="right" valign="center">-k<sub>4</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>5</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">2k<sub>6</sub>/3</td><td style="" align="right" valign="center">8k<sub>6</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub>/3</td><td style="" align="right" valign="center">k<sub>8</sub></td><td style="" align="right" valign="center">3k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">6</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">-4k<sub>1</sub>/3</td><td style="" align="right" valign="center">-k<sub>1</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub>/3</td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>3</sub></td><td style="" align="right" valign="center">k<sub>4</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>5</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">8k<sub>6</sub>/3</td><td style="" align="right" valign="center">2k<sub>6</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub>/3</td><td style="" align="right" valign="center">2k<sub>8</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">7</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>3</sub></td><td style="" align="right" valign="center">-k<sub>4</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">2k<sub>6</sub>/3</td><td style="" align="right" valign="center">2k<sub>6</sub>/3</td><td style="border-right: 1px solid ; " align="right" valign="center">8k<sub>6</sub>/3</td><td style="" align="right" valign="center">k<sub>8</sub></td><td style="" align="right" valign="center">-3k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">8</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>3</sub></td><td style="" align="right" valign="center">k<sub>4</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-0</td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-k<sub>8</sub></td><td style="" align="right" valign="center">-3k<sub>7</sub></td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">9</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>2</sub></td><td style="" align="right" valign="center">-k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>3</sub></td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-0</td><td style="" align="right" valign="center">-2k<sub>8</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">10</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>2</sub></td><td style="" align="right" valign="center">k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>3</sub></td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-0</td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">11</td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-k<sub>3</sub></td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">-0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">12</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="" align="right" valign="center">k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>1</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>1</sub></td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">2k<sub>2</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">-k<sub>4</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">k<sub>3</sub></td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-0</td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">13</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">-2k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">-0</td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">14</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">2k<sub>2</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">0</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">0</td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">-0</td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr align="right" valign="center"><td style="border-right: 1px solid ; " align="center" valign="center">15</td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="" align="right" valign="center"> </td><td style="border-right: 1px solid ; " align="right" valign="center"> </td><td style="" align="right" valign="center">2k<sub>6</sub></td><td style="" align="right" valign="center">0</td><td style="border-right: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="" align="right" valign="center">-0</td><td style="" align="right" valign="center">-2k<sub>6</sub></td><td style="border-right: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td><td class="auto-generated" style=""> </td></tr><tr style="border-bottom: 1px solid ; " align="right" valign="center"><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="center" valign="center">16</td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center"> </td><td style="border-bottom: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="border-bottom: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center">0</td><td style="border-bottom: 1px solid ; " align="right" valign="center">-2k<sub>6</sub></td><td style="border-bottom: 1px solid ; " align="right" valign="center">-0</td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="right" valign="center">2k<sub>6</sub></td><td class="auto-generated" style="border-bottom: 1px solid ; "> </td><td class="auto-generated" style="border-bottom: 1px solid ; "> </td><td class="auto-generated" style="border-bottom: 1px solid ; "> </td></tr><tr><td style="" colspan="25" align="left">
            <span class="mathphrase">k<sub>1</sub> = sqrt(2) / 2</span>,
            <span class="mathphrase">k<sub>2</sub> = 14 / (8 sqrt(3) + 12)</span>,
            <span class="mathphrase">k<sub>3</sub> = sqrt(2/(5 + sqrt(5)))</span>,
            <span class="mathphrase">k<sub>4</sub> = sqrt(1/10 (5 + sqrt(5)))</span>
          </td></tr><tr><td style="" colspan="25" align="left">
            <span class="mathphrase">k<sub>5</sub> = 1</span>,
            <span class="mathphrase">k<sub>6</sub> = 4/(6 sqrt(2) + sqrt(3))</span>,
            <span class="mathphrase">k<sub>7</sub> = (6 sqrt(3) - 3) / 22</span>,
            <span class="mathphrase">k<sub>8</sub> = (18 - 3 sqrt(3)) / 22</span>
          </td></tr></tbody></table>
      </div><p>
      The reference templates are scaled such that the mean distance of the neighbors is 1.  This is a slight departure from the templates in the published PTM paper, in that the central atom is no longer included in this calculation.
  </p>

  </div>

  <div class="simplesect" id="idp4926288"><div class="titlepage"><div><div><h4 class="title">Elastic deformation gradients</h4></div></div></div>
    
    <p>
      The modifier also provides the option to compute a local elastic deformation gradient for each particle, which is calculated as the
      affine transformation of the ideal template which minimizes the sum of squared deviations from the actual neighbor vectors.
      The local elastic deformation gradient tensors are output as 3x3 matrices in the <span class="emphasis"><em>Elastic Deformation Gradient</em></span>
      particle property.
    </p>
  </div>

  <div class="simplesect" id="idp4928288"><div class="titlepage"><div><div><h4 class="title">Ordering types</h4></div></div></div>
    
    <p>
      The chemical types of atoms are generally ignored by the PTM when identifying the <span class="emphasis"><em>structural</em></span> phases (e.g. FCC, BCC, etc.). However, the algorithm can additionally
      identify the local chemical ordering type by taking into account the species of atoms (given by the values of the <code class="literal">Particle Type</code> property, which must be defined).
      The binary ordering types identified by the current version of the PTM algorithm are A2 and B2 for BCC;
      A1, L1<sub>0</sub> and L1<sub>2</sub> for FCC; zinblende for cubic diamond; and wurtzite for hexagonal diamond structures.
    </p>
    <p>
      The local ordering type is output as an additional particle property named <code class="literal">Ordering Type</code> with the following values:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
      <p>0 = Other, unknown or no ordering</p>
    </li><li class="listitem">
      <p>1 = Pure (all neighbors like central atom)</p>
    </li><li class="listitem">
      <p>2 = L1<sub>0</sub></p>
    </li><li class="listitem">
      <p>3 = L1<sub>2</sub> (A-site)</p>
    </li><li class="listitem">
      <p>4 = L1<sub>2</sub> (B-site)</p>
    </li><li class="listitem">
      <p>5 = B2</p>
    </li><li class="listitem">
      <p>6 = zincblende / wurtzite</p>
    </li></ul></div><p>
    The algorithm determines the ordering type at a lattice atom by comparing the types of its neighbors to the type of the central atom. See the paper for details.
    You can subsequently use the <a class="link" href="particles.modifiers.expression_select.html" title="Expression selection">Expression selection</a> modifier to select atoms of a
    certain structural type and a certain ordering type to give them a distinct color, for example.
    </p>
  </div>

  <div class="simplesect" id="idp4941968"><div class="titlepage"><div><div><h4 class="title">Notes</h4></div></div></div>
  
  <p>
    In addition to the PTM, OVITO provides alternative structure identification tools
    like the <a class="link" href="particles.modifiers.common_neighbor_analysis.html" title="Common neighbor analysis">Common Neighbor Analysis</a> modifier, the <a class="link" href="particles.modifiers.identify_diamond_structure.html" title="Identify diamond structure">Identify Diamond Structure</a> modifier, or the <a class="link" href="particles.modifiers.bond_angle_analysis.html" title="Ackland-Jones analysis">Ackland-Jones Analysis</a> modifier.
  </p>

  <p>
    Note that this modifier requires access to the complete set of input particles to perform the analysis. It should therefore be placed at the
    beginning of the processing pipeline, preceding any modifiers that delete particles.
  </p>

  <p>
    The <span class="emphasis"><em>Use only selected particles</em></span> option restricts the analysis to the
    currently selected particles. If this option is checked, unselected particles will be ignored
    (as if they did not exist) and will be assigned the structure type "Other".
    This option can be useful if you want to identify defects in a crystal structure that is
    not directly supported by the PTM algorithm, but which possesses a known sublattice.
  </p>
  </div>

  <div class="simplesect" id="idp4947616"><div class="titlepage"><div><div><h4 class="title">See also</h4></div></div></div>
  
    <p>
      <a class="pydoc-link" href="python/modules/ovito_modifiers.html#ovito.modifiers.PolyhedralTemplateMatchingModifier" target="_top"><code class="classname">PolyhedralTemplateMatchingModifier</code> (Python API)</a><a class="ovito-pro-tag" data-tooltip="This program feature is only available in the Pro edition of OVITO. Click to learn more." data-tooltip-position="bottom" href="https://www.ovito.org/about/ovito-pro/">
    pro
  </a>
    </p>
  </div>

</div><p class="footer_copyright">© 2021  OVITO GmbH</p><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="particles.modifiers.manual_selection.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="particles.modifiers.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="particles.modifiers.python_script.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Manual selection </td><td width="20%" align="center"><a accesskey="h" href="index.html">Table of Contents</a></td><td width="40%" align="right" valign="top"> Python script modifier<a class="ovito-pro-tag" data-tooltip="This program feature is only available in the Pro edition of OVITO. Click to learn more." data-tooltip-position="bottom" href="https://www.ovito.org/about/ovito-pro/">
    pro
  </a></td></tr></table></div></body></html>
